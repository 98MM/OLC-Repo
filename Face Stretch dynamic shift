// -----JS CODE-----
//------Increases a face stretch till it reaches the Max Intensity when  
//------the user opens their mouth, then decreases to 0 when they close their mouth.
//------ Written by Ben Knutson
// @input Component.FaceStretchVisual stretch
// @input float intensityMax
// @input float upSpeed
// @input float downSpeed
var feature = "Feature0";
var intensity = 0;

var openEvent = script.createEvent("MouthOpenedEvent");
openEvent.faceIndex = 0;
openEvent.bind(function (eventData)
{
    increaseStretch();
});

var closeEvent = script.createEvent("MouthClosedEvent");
closeEvent.faceIndex = 0;
closeEvent.bind(function (eventData)
{
    decreaseStretch();
});



function increaseStretch()
{

var event1 = script.createEvent("UpdateEvent");
event1.bind(function (eventData)
{
        if (intensity <= script.intensityMax)
        {
    intensity += script.upSpeed;
    script.stretch.setFeatureWeight(feature, intensity);
        }
        else
        {
            intensity = script.intensityMax;
            script.stretch.setFeatureWeight(feature, intensity);  
            event1.enabled = false;
            return;
        }
});
    
}

function decreaseStretch()
{
    var event2 = script.createEvent("UpdateEvent");
event2.bind(function (eventData)
{
        if (intensity >= 0)
        {
    intensity -= script.downSpeed;
    script.stretch.setFeatureWeight(feature, intensity);
        }
        else
        {
            intensity = 0;
            script.stretch.setFeatureWeight(feature, intensity);  
            event2.enabled = false;
            return;
        }
});
    
}
